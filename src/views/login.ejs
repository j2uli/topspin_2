<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Iniciar sesión - TopSpin</title>
  <link rel="stylesheet" href="/css/register.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div class="container">
    <div class="logo-section">
      <img src="/img/logo.png" alt="TopSpin Logo" class="logo flipped" />
    </div>
    <div class="form-section">
      <h2>Iniciar sesión</h2>
      <form action="/login" method="POST">
        <input type="email" name="correo" placeholder="Correo electrónico" required />

        <div class="password-wrapper">
          <input type="password" name="contraseña" id="contraseña" placeholder="Contraseña" required />
          <span class="toggle-password" id="togglePassword"><i class="fas fa-eye"></i></span>
        </div>

        <select name="rol" required>
          <option value="">Selecciona tu rol</option>
          <option value="cliente">Cliente</option>
          <option value="tecnico">Técnico</option>
          <option value="admin">Administrador</option>
        </select>

        <button type="submit">Entrar</button>
      </form>

      <p class="login-prompt">
        ¿No tienes cuenta?
        <a href="/register" class="login-link">Regístrate</a>
      </p>
    </div>
  </div>

  <% if (notificacion) { %>
  <div class="notification <%= notificacion.tipo %> show">
    <strong><%= notificacion.tipo === 'success' ? '¡Éxito!' : 'Error' %>:</strong> <%= notificacion.mensaje %>
  </div>
  <script>
    setTimeout(() => {
      const notif = document.querySelector('.notification');
      if (notif) notif.classList.remove('show');
    }, 5000);
  </script>
  <% } %>

  <script>
    const togglePassword = document.getElementById('togglePassword');
    const contraseñaInput = document.getElementById('contraseña');
    const toggleIcon = togglePassword.querySelector('i');

    togglePassword.addEventListener('click', () => {
      const type = contraseñaInput.getAttribute('type') === 'password' ? 'text' : 'password';
      contraseñaInput.setAttribute('type', type);
      toggleIcon.classList.toggle('fa-eye');
      toggleIcon.classList.toggle('fa-eye-slash');
    });
  </script>
</body>
</html>
